var SRCS = files(".") with ending(".cpp")
var OBJS = swap(".cpp" ".o") on expand(SRCS)

var CC = "g++"
var FLAGS = "-std=c++14 -Wall -Wno-strict-aliasing -pedantic -s -Os -fno-ident -fno-rtti -fno-exceptions -fmerge-all-constants -Iinclude"
var TARGET = "basil"

for src obj in OBJS do
    if newer(src obj) do
        run(CC FLAGS "-c" src "-o" obj)
    end
end

run(CC FLAGS outputs(OBJS) "-o" TARGET)